import*as tslib_1 from"tslib";import"../../CommonImports";import"../../Core/core.css";import"./TextField.css";import*as React from"react";import{FocusWithin}from"../../FocusWithin";import{FocusZoneContext}from"../../FocusZone";import{FormItemContext}from"../../FormItem";import{Icon}from"../../Icon";import{Observer}from"../../Observer";import{Tooltip}from"../../TooltipEx";import{css,getSafeId}from"../../Util";import{getTabIndex}from"../../Utilities/Focus";var inputId=1,TextField=function(e){function t(t){var n=e.call(this,t)||this;return n.select=function(){n.inputElement.current&&n.inputElement.current.select()},n.inputId="textfield-input-"+inputId++,n.inputElement=t.inputElement||React.createRef(),n}return tslib_1.__extends(t,e),t.prototype.focus=function(){this.inputElement.current&&this.inputElement.current.focus()},Object.defineProperty(t.prototype,"selectionEnd",{get:function(){return this.inputElement.current?this.inputElement.current.selectionEnd:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectionStart",{get:function(){return this.inputElement.current?this.inputElement.current.selectionStart:null},enumerable:!0,configurable:!0}),t.prototype.setSelectionRange=function(e,t,n){this.inputElement.current&&this.inputElement.current.setSelectionRange(e,t,n)},t.prototype.render=function(){var e=this,t=this.props,n=t.className,o=t.containerClassName,r=t.disabled,i=t.focusTreatment,a=void 0===i?0:i,l=t.inputId,s=t.label,u=t.onBlur,c=t.onFocus,p=t.style,d=t.value,m=t.width,f=React.createElement(FocusWithin,{onFocus:c,onBlur:u},function(t){return React.createElement(FormItemContext.Consumer,null,function(i){return React.createElement("div",{className:css("flex-column",o,"auto"!==m&&m)},React.createElement("div",{className:css(!s&&n,"bolt-textfield flex-row flex-center",r&&"disabled",0===a&&"focus-treatment",1===a&&"focus-keyboard-only",t.hasFocus&&"focused",1===p&&"bolt-textfield-inline",i.error&&"bolt-textfield-error")},React.createElement(FocusZoneContext.Consumer,null,function(n){return React.createElement(Observer,{value:d},function(o){return React.createElement(TextFieldInnerValue,tslib_1.__assign({},e.props,{focus:function(){return e.focus()},focusStatus:t,formItemContext:i,inputElement:e.inputElement,inputId:e.props.inputId||e.inputId,value:o.value,zoneContext:n}))})})))})});return s?React.createElement("div",{className:css(n,"flex-column")},React.createElement("label",{htmlFor:getSafeId(l||this.inputId),className:"bolt-textfield-label"},s),f):f},t}(React.Component);export{TextField};var TextFieldInnerValue=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.adjustedHeightValue="",t}return tslib_1.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.activatable,o=t.ariaActiveDescendant,r=t.ariaAutoComplete,i=t.ariaControls,a=t.ariaExpanded,l=t.ariaHasPopup,s=t.ariaLabel,u=t.ariaLabelledBy,c=t.ariaRoleDescription,p=t.autoAdjustHeight,d=t.autoComplete,m=t.autoFocus,f=t.autoSelect,b=t.disabled,h=t.excludeFocusZone,x=t.focus,g=t.focusStatus,I=t.formItemContext,y=t.inputClassName,v=t.inputElement,C=t.inputId,E=t.inputType,F=t.maxLength,_=t.multiline,R=t.onClick,S=t.onKeyDown,N=t.onKeyPress,j=t.onKeyUp,T=t.onPaste,k=t.placeholder,H=t.prefixIconProps,P=t.readOnly,w=t.required,z=t.resizable,B=t.role,D=t.rows,O=t.spellCheck,K=t.tooltipProps,L=t.value,U=t.zoneContext,V=this.props,A=V.ariaDescribedBy,Z=V.suffixIconProps,W=_?"textarea":"input",q=_?{rows:D}:{type:E,autoComplete:d?"on":"off"};void 0===Z&&I.error&&(Z={className:"bolt-textfield-message-error",iconName:"Error"}),void 0===A&&(A=I.ariaDescribedById);var M=React.createElement(W,tslib_1.__assign({},q,{"aria-activedescendant":getSafeId(o),"aria-autocomplete":r,"aria-controls":getSafeId(i),"aria-describedby":getSafeId(A),"aria-disabled":b,"aria-expanded":a,"aria-haspopup":l,"aria-label":void 0===s&&k?k:s,"aria-labelledby":getSafeId(u)||getSafeId(I.ariaLabelledById),"aria-readonly":E&&"text"!==E?P:void 0,"aria-roledescription":c,autoFocus:m,"data-focuszone":b||h?void 0:U.focuszoneId,disabled:b,className:css(y,"bolt-textfield-input flex-grow",p&&"bolt-textfield-auto-adjust",z&&"bolt-textfield-auto-unresizable",H&&"bolt-textfield-input-with-prefix",Z&&"bolt-textfield-input-with-suffix",n&&"activatable"),id:getSafeId(C),maxLength:F,onBlur:g.onBlur,onClick:R,onChange:function(t){e.props.onChange&&e.props.onChange(t,t.target.value),e.adjustHeight()},onFocus:function(e){f&&v.current&&v.current.select(),g.onFocus&&g.onFocus(e)},onKeyDown:S,onKeyPress:N,onKeyUp:j,onPaste:T,placeholder:k,readOnly:P,required:w,ref:v,role:B,spellCheck:O,tabIndex:getTabIndex(this.props),value:L||""}));return React.createElement(React.Fragment,null,H&&Icon(tslib_1.__assign({size:"medium"},H,{className:css(H.className,"prefix",!H.render&&"bolt-textfield-icon",(k&&!L||H.render)&&"bolt-textfield-no-text"),onClick:function(e){H&&H.onClick&&H.onClick(e),x()}})),K?React.createElement(Tooltip,tslib_1.__assign({},K),M):M,Z&&Icon(tslib_1.__assign({size:"medium"},Z,{className:css(Z.className,"suffix",!Z.render&&"bolt-textfield-icon",(k&&!L||Z.render)&&"bolt-textfield-no-text"),onClick:function(e){Z&&Z.onClick&&Z.onClick(e),x()}})))},t.prototype.componentDidMount=function(){this.adjustHeight()},t.prototype.componentDidUpdate=function(){this.adjustHeight()},t.prototype.adjustHeight=function(){var e=this.props,t=e.autoAdjustHeight,n=e.inputElement,o=e.multiline,r=e.value;o&&t&&n.current&&r!==this.adjustedHeightValue&&(n.current.style.height="",n.current.style.height=n.current.scrollHeight+"px",this.adjustedHeightValue=n.current.value)},t}(React.Component);